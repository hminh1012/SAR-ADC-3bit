* C:\Users\Windows\Documents\GitHub\SAR-ADC-3bit\SAR_ADC_3Bit_full.asc
* Generated by LTspice 24.1.10 for Windows.
X§X1 Vcomp B0 B1 B2 NC_01 RST D0 D1 D2 NC_02 VDD SuccessiveApproximationRegister
X§X3 Vin B2 VrefM VDD/2 O2 RST VrefP SwitchModule
X§X4 Vin B1 VrefM VDD/2 O1 RST VrefP SwitchModule
X§X5 Vin B0 VrefM VDD/2 O0 RST VrefP SwitchModule
VDD/2 VDD/2 0 .5
C1 Vx Or {C}
C2 Vx O0 {C}
C3 Vx O1 {2*C}
C4 Vx O2 {4*C}
VDDi VDDi 0 1
S1 Vx Vcm RST VDD/2 SW
X§X6 Vin 0 VrefM VDD/2 Or RST VrefP SwitchModule
Vin Vin 0 SINE(0.5 0.5 1Meg 0 0 0)
V2 VDD 0 5
V3 VrefM 0 {VrefM}
V4 VrefP 0 {VrefP}
V6 Vcm 0 2.5
X§U1 Vcm Vx VDDi VrefM Vcomp MyComparator ;§pnba in+)in-)pos)neg)out
X§X2 D2 D1 D0 Vout VrefP VrefM VDD Ideal_3_bit_DAC
Vsawtooth NC_03 0 PULSE({VrefM} {VrefP} 0 {tr} 0 0 {tr})

* block symbol definitions
.subckt SuccessiveApproximationRegister Comp B0 B1 B2 B3 RST D0 D1 D2 D3 VDD
A1 Comp 0 _P2 Pre2 N001 0 B2 0 DFLOP td=.5n
A2 Comp 0 _P1 Pre1 N001 0 B1 0 DFLOP td=.5n
A4 B2 0 RST 0 0 0 N002 0 DFLOP
A5 B1 0 RST 0 0 0 N003 0 DFLOP
A6 B0 0 RST 0 0 0 N004 0 DFLOP
X§X1 RST P0 P1 P2 NC_06 CLK _CLK _RST _P0 _P1 _P2 NC_07 Pon StateGen
A10 P2 CLK 0 0 0 0 Pre2 0 AND
A11 P1 CLK 0 0 0 0 Pre1 0 AND
A12 P0 CLK 0 0 0 0 Pre0 0 AND
A13 _RST 0 0 0 0 N001 0 0 BUF td=1n
S3 VDD D2 N002 VDD/2 SW
S4 D2 0 VDD/2 N002 SW
S5 VDD D1 N003 VDD/2 SW
S6 D1 0 VDD/2 N003 SW
S7 VDD D0 N004 VDD/2 SW
S8 D0 0 VDD/2 N004 SW
VDD1 VDD/2 0 .5
A3 Comp 0 _P0 Pre0 N001 0 B0 0 DFLOP td=.5n
.model SW SW
.ends SuccessiveApproximationRegister

.subckt SwitchModule Vin Bit VrefM VDD/2 Out RST VrefP
S1 VrefP N001 Bit VDD/2 SW
S2 N001 VrefM VDD/2 Bit SW
S3 Vin Out RST VDD/2 SW
S4 Out N001 VDD/2 RST SW
.model SW SW
.ends SwitchModule

.subckt Ideal_3_bit_DAC B2 B1 B0 Vout Vrefp Vrefm VDD
R1 Vtrip 0 100Meg
R2 VDD Vtrip 100Meg
S7 B2L Vone B2 Vtrip switmod
S8 0 B2L Vtrip B2 switmod
S13 B1L Vone B1 Vtrip switmod
S14 0 B1L Vtrip B1 switmod
S15 B0L Vone B0 Vtrip switmod
S16 0 B0L Vtrip B0 switmod
B1 Vout 0 V=((v(vrefp)-v(vrefm))/8)*(v(B2L)*4+v(B1L)*2+v(B0L))+v(vrefm)
R3 Vrefp Vrefm 100Meg
Vone Vone 0 1
.model switmod SW
.ends Ideal_3_bit_DAC

.subckt StateGen RST P0 P1 P2 P3 CLK _CLK _RST _P0 _P1 _P2 _P3 Pon
A1 _Qc1 0 Clki 0 Pon _Qc0 Qc0 0 DFLOP td=1n
A2 Qc0 0 Clki 0 Pon _Qc1 Qc1 0 DFLOP td=1n
V§Clk Clki 0 PULSE(0 1 0 .5n .5n 4.5n 10n)
V1 Pon 0 PULSE(0 1 0 .5n .5n 5n 100 1)
A4 _Qc0 _Qc1 0 N004 0 _RST RST 0 AND
A9 _Qc0 Qc1 N001 0 0 _P0 P0 0 AND
A10 Qc0 Qc1 N002 0 0 _P1 P1 0 AND
A11 Clki 0 0 0 0 _Clki 0 0 BUF
A12 _Clki _Clki_d 0 0 0 0 _Clk 0 AND
A13 Clki 0 0 0 0 _Clki_d 0 0 BUF td=1n
A14 Clki 0 0 0 0 0 Clki_d 0 BUF td=1n
A15 Clki Clki_d 0 0 0 0 Clk 0 AND
A6 Qc0 _Qc1 N003 0 0 _P2 P2 0 AND
A17 _Qc1 0 0 0 0 0 N004 0 BUF td=1n
A19 Qc1 0 0 0 0 0 N001 0 BUF td=1n
A20 Qc0 0 0 0 0 0 N002 0 BUF td=1n
A21 Qc0 0 0 0 0 0 N003 0 BUF td=1n
.ends StateGen

.param C=1p
.model SW SW
.param VrefP=1
.param VrefM=0
.param tr=1.6u
.tran 3.2u
.lib MyComparator.sub
.backanno
.end
